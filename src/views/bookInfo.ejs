<!DOCTYPE html>
<html>
<head> 
	<!-- Update links to use correct format -->
    <a href="/book_info/<%= book.bookID %>">View Book</a>

	<title>View Book Information Page</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom CSS -->
	<link rel="stylesheet" href="./css/styleProfile.css">
	<link rel="stylesheet" href="css/stylesUpload.css">
	<link rel="stylesheet" href="./css/avtDropDown.css">
	<!-- Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&amp;display=swap" data-tag="font" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" data-tag="font" />
	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
	<!-- Book Info -->
	<div class="container">
		<div class="row">
			<!-- First Section -->
			<div class="col-md-8">
				<div class="row">
					<div class="col-md-4">
                        <img src="<%= `https://happinovel.blob.core.windows.net/bookcover/coverImg${book.bookID}.jpg` %>" class="img-fluid" alt="Book Cover">
                    </div>                    
					<div class="col-md-8">
						<h2><%= book.title %></h2>
						<div class="mb-2">
                            <% bookGenres.forEach(bookGenre => { %>
                                <% const genre = genres.find(genre => genre.genreID === bookGenre.genreID); %>
                                <% if (genre) { %>
                                    <span class="badge badge-primary"><%= genre.genreName %></span>
                                <% } %>
                            <% }) %>
                        </div>
						<p>Tác giả: <%= book.authorName %></p>
						<p>Tình trạng: 
							<% if (book.status === 0) { %>
								Tạm ngưng
							<% } else if (book.status === 1) { %>
								Đang tiến hành 
							<% } else if (book.status === 2) { %>
								Hoàn thành 
							<% } %>
						</p>						
						<div class="d-flex">
							<a href="#"><i class="far fa-heart mr-2"></i></a>
							<a href="#"><i class="far fa-star mr-2"></i></a>
							<a href="#chapter-list"><i class="fas fa-list mr-2"></i></a>
							<a href="#comments"><i class="far fa-comments"></i></a>
						</div>
						<p class="mt-3"><%= book.description %></p>
					</div>
				</div>
				<hr>
			</div>
			<!-- Second Section -->
			<div class="col-md-12 mt-5">
				<h3>Book Summary</h3>
				<p><%= book.summary %></p>
				<hr>
			</div>
			<!-- Third Section -->
			<div class="col-md-12 mt-5">
				<h3>Volume List</h3>
				<div class="accordion" id="volume-list">
					<% book.volumes.forEach((volume, index) => { %>
						<div class="card">
							<div class="card-header" id="volume<%= index + 1 %>-heading">
								<h5 class="mb-0">
									<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#volume<%= index + 1 %>-collapse" aria-expanded="true" aria-controls="volume<%= index + 1 %>-collapse">
										Volume <%= index + 1 %>: <%= volume.title %>
									</button>
								</h5>
							</div>
							<div id="volume<%= index + 1 %>-collapse" class="collapse <%= index === 0 ? 'show' : '' %>" aria-labelledby="volume<%= index + 1 %>-heading" data-parent="#volume-list">
								<div class="card-body">
									<ul class="list-group" id="chapter-list-volume<%= index + 1 %>">
										<% volume.chapters.forEach((chapter, cIndex) => { %>
											<li class="list-group-item"><a href="#"><%= chapter.title %></a></li>
										<% }) %>
									</ul>
								</div>
							</div>
						</div>
					<% }) %>
				</div>
				<hr>
			</div>
			<!-- Fourth Section -->
			<div class="col-md-12 mt-5">
				<h3>Comments</h3>
				<!-- Add comments section here using the book.comments data -->
				<hr>
			</div>
			<!-- Add the comment form here -->
		</div>
		<!-- Sidebar -->
		<div class="col-md-4">
			<div class="card mt-5">
				<div class="card-header">
					<h4>Author Information</h4>
				</div>
				<div class="card-body">
					<img src="./Image/avatar.png" alt="Author Avatar" class="img-fluid rounded-circle" width="128" height="128">
					<h5 class="mt-3"><%= book.authorName %></h5>
					<p class="mt-2"><%= book.authorBio %></p>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

